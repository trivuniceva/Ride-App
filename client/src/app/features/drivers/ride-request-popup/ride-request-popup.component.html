<div class="popup-overlay" *ngIf="visible">
  <div class="popup">
    <ng-container *ngIf="popupType === 'request'">
      <h3>üì¢ Nova vo≈ænja</h3>
      <p>{{ message }}</p>
      <button (click)="onAcceptRequest()">Prihvati</button>
      <button (click)="onRejectRequest()">Odbij</button>
    </ng-container>

    <ng-container *ngIf="popupType === 'action'">
      <ng-container *ngIf="isArrivedAtDestination && !showCancellationReason">
        <h2>Vo≈ænja je zavr≈°ena!</h2>
        <p>{{ message }}</p> <div class="button-group">
        <button class="btn btn-finish" (click)="onCompleteRide()">Zavr≈°i vo≈ænju</button>
      </div>
      </ng-container>

      <ng-container *ngIf="!isArrivedAtDestination && !showCancellationReason">
        <h2>Stigli ste na polaziste!</h2>
        <p>{{ message }}</p> <div class="button-group">
        <button class="btn btn-cancel" (click)="onCancelRidePrompt()">Otka≈æi vo≈ænju</button>
        <button class="btn btn-start" (click)="onStartRide()">Zapoƒçni vo≈ænju</button>
      </div>
      </ng-container>

      <ng-container *ngIf="showCancellationReason && !isArrivedAtDestination">
        <h2>Razlog otkazivanja vo≈ænje</h2>
        <p>Molimo navedite detaljan razlog otkazivanja:</p>
        <textarea [(ngModel)]="cancellationReason"
                  placeholder="Unesite razlog (min. 10 karaktera)"
                  [ngClass]="{'is-invalid': isReasonInvalid}"></textarea>
        <div *ngIf="isReasonInvalid" class="error-message">
          Razlog mora imati najmanje 10 karaktera.
        </div>
        <div class="button-group">
          <button class="btn btn-back" (click)="onBackToActions()">Nazad</button>
          <button class="btn btn-confirm-cancel" (click)="onConfirmCancel()">Potvrdi otkazivanje</button>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>
